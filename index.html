<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h1>Test</h1>
    <p>Da staht eifach mal öppis</p>
</body>

<div id="map" style="height: 500px; width: 100%;"></div>

<script>
  // Function to initialize the map
  function initMap() {
    var mapOptions = {
      center: {lat: 47.3769, lng: 8.5417},  // Center the map on Zürich
      zoom: 12
    };
    var map = new google.maps.Map(document.getElementById('map'), mapOptions);

    // Fetch data from Google Sheets via Google Apps Script
    fetch("YOUR_WEB_APP_URL")
      .then(response => response.json())
      .then(data => {
        data.forEach(point => {
          var marker = new google.maps.Marker({
            position: {lat: parseFloat(point.latitude), lng: parseFloat(point.longitude)},
            map: map,
            title: "Graffiti location"
          });

          // Add a click event to show an info window with the description
          var infowindow = new google.maps.InfoWindow({
            content: `<div><p><strong>Description:</strong> ${point.image}</p><br>Submitted on: ${point.timestamp}</div>`
          });

          marker.addListener('click', function() {
            infowindow.open(map, marker);
          });
        });
      });
  }
</script>

<!-- Load Google Maps JavaScript API -->
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDdYKHrhsqia5E7pHrPGuBlSFKcCSQCpj8&callback=initMap" async defer></script>


<form id="graffiti-form" method="POST" action="https://script.google.com/macros/s/AKfycbxSeX12lKCJorLCPRLc6lcHch-RdA1Rpw_rl15aAfXluFRgOig_kJjdIJD_Jagyd-jhQA/exec" enctype="multipart/form-data">

    <label for="location">Choose Location:</label><br>
    <button type="button" onclick="openMap()">Select on Map</button><br><br>
  
    <label for="title">Add a short description:</label>
    <input type="text" id="title" name="title" required><br><br>
  
    <label for="description">Add a short description:</label>
    <input type="text" id="description" name="description" required><br><br>
  
    <label for="image">Graffiti Image (URL):</label><br>
    <input type="text" id="image" name="image" placeholder="Image URL" required><br><br>
  
    <!-- Hidden fields to store selected coordinates -->
    <input type="hidden" id="latitude" name="latitude">
    <input type="hidden" id="longitude" name="longitude">
  
    <button type="submit">Submit</button>
  </form>
  
  <!-- Modal or Section for Google Map -->
  <div id="mapModal" style="display:none; width:100%; height:400px; border:1px solid black;">
    <div id="map" style="height: 100%;"></div>
    <button onclick="confirmLocation()">Confirm Location</button>
  </div>
  
  
  <script>
    var map;
    var marker;
  
    function initMap() {
      map = new google.maps.Map(document.getElementById('map'), {
        center: {lat: 47.3769, lng: 8.5417},  // Centered on Zürich
        zoom: 10
      });
  
      // Add a click event listener to the map
      map.addListener('click', function(event) {
        placeMarker(event.latLng);
      });
    }
  
    // Place a marker at the clicked location and store the coordinates
    function placeMarker(location) {
      if (marker) {
        marker.setPosition(location);
      } else {
        marker = new google.maps.Marker({
          position: location,
          map: map
        });
      }
  
      // Store the latitude and longitude in the hidden form fields
      document.getElementById('latitude').value = location.lat();
      document.getElementById('longitude').value = location.lng();
    }
  
    // Open the map modal
    function openMap() {
      document.getElementById('mapModal').style.display = 'block';
      google.maps.event.trigger(map, 'resize');  // Refresh the map display after showing it
    }
  
    // Confirm the location and close the map modal
    function confirmLocation() {
      document.getElementById('mapModal').style.display = 'none';
    }
  </script>
  
  <!-- Google Maps API -->
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDdYKHrhsqia5E7pHrPGuBlSFKcCSQCpj8&callback=initMap" async defer></script>
  

</html>